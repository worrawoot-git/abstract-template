<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏ó‡∏Ñ‡∏±‡∏î‡∏¢‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sarabun', 'TH SarabunPSK', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .form-section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .form-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .input-group {
            margin-bottom: 10px;
        }

        input[type="text"],
        input[type="number"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 10px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
            margin-right: 8px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .add-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .add-btn:hover {
            background: #218838;
        }

        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
            transition: background 0.3s;
        }

        .remove-btn:hover {
            background: #c82333;
        }

        .dynamic-input {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .dynamic-input input,
        .dynamic-input textarea {
            flex: 1;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-save {
            background: #667eea;
            color: white;
        }

        .btn-save:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .btn-preview {
            background: #17a2b8;
            color: white;
        }

        .btn-preview:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .btn-export {
            background: #ffc107;
            color: #333;
        }

        .btn-export:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }

        .btn-reset {
            background: #6c757d;
            color: white;
        }

        .btn-reset:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .output-section {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }

        .output-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 22px;
        }

        .output-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            line-height: 1.8;
            text-align: justify;
            margin-bottom: 20px;
        }

        .keywords-input {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
        }

        .sub-label {
            font-weight: bold;
            color: #555;
            margin-bottom: 5px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìù ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏ó‡∏Ñ‡∏±‡∏î‡∏¢‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h1>

        <form id="researchForm">
            <!-- Section 1 -->
            <div class="form-section">
                <h3>1. ‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h3>
                <div id="objectives">
                    <div class="dynamic-input">
                        <input type="text" name="objective[]" placeholder="1.1 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                    </div>
                    <div class="dynamic-input">
                        <input type="text" name="objective[]" placeholder="1.2 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                    </div>
                    <div class="dynamic-input">
                        <input type="text" name="objective[]" placeholder="1.3 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                    </div>
                </div>
                <button type="button" class="add-btn" onclick="addObjective()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå</button>
            </div>

            <!-- Section 2 -->
            <div class="form-section">
                <h3>2. ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ß‡∏¥‡∏à‡∏±‡∏¢</h3>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="method" value="‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì"> ‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì
                    </label>
                    <label>
                        <input type="checkbox" name="method" value="‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û"> ‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û
                    </label>
                    <label>
                        <input type="checkbox" name="method" value="‡πÄ‡∏ä‡∏¥‡∏á‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ"> ‡πÄ‡∏ä‡∏¥‡∏á‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ
                    </label>
                </div>
                <div id="additionalMethods"></div>
                <button type="button" class="add-btn" onclick="addMethod()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ò‡∏µ‡∏ß‡∏¥‡∏à‡∏±‡∏¢</button>
            </div>

            <!-- Section 3 -->
            <div class="form-section">
                <h3>3. ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà</h3>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" name="tool" value="‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå"> ‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå
                    </label>
                    <label>
                        <input type="checkbox" name="tool" value="‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°"> ‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°
                    </label>
                    <label>
                        <input type="checkbox" name="tool" value="‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö"> ‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö
                    </label>
                    <label>
                        <input type="checkbox" name="tool" value="‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô"> ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
                    </label>
                    <label>
                        <input type="checkbox" name="tool" value="‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï"> ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï
                    </label>
                </div>
                <div id="additionalTools"></div>
                <button type="button" class="add-btn" onclick="addTool()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</button>
            </div>

            <!-- Section 4 -->
            <div class="form-section">
                <h3>4. ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà</h3>
                <textarea name="sample" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"></textarea>
            </div>

            <!-- Section 5 -->
            <div class="form-section">
                <h3>5. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</h3>
                <input type="number" name="sampleSize" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)">
            </div>

            <!-- Section 6 -->
            <div class="form-section">
                <h3>6. ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏ö‡∏ß‡πà‡∏≤</h3>
                <div id="findings">
                    <div class="dynamic-input">
                        <textarea name="finding[]" placeholder="6.1 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤"></textarea>
                    </div>
                    <div class="dynamic-input">
                        <textarea name="finding[]" placeholder="6.2 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤"></textarea>
                    </div>
                    <div class="dynamic-input">
                        <textarea name="finding[]" placeholder="6.3 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤"></textarea>
                    </div>
                </div>
                <button type="button" class="add-btn" onclick="addFinding()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</button>
            </div>

            <!-- Section 7 -->
            <div class="form-section">
                <h3>7. ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ô‡∏µ‡πâ</h3>
                <textarea name="recommendation" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞"></textarea>
            </div>

            <!-- Section 8 -->
            <div class="form-section">
                <h3>8. ‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (Keywords)</h3>
                <div class="keywords-input">
                    <input type="text" name="keyword[]" placeholder="‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà 1">
                    <input type="text" name="keyword[]" placeholder="‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà 2">
                    <input type="text" name="keyword[]" placeholder="‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà 3">
                    <input type="text" name="keyword[]" placeholder="‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà 4">
                    <input type="text" name="keyword[]" placeholder="‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà 5">
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button type="button" class="btn btn-save" onclick="saveData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                <button type="button" class="btn btn-preview" onclick="generatePreview()">üëÅÔ∏è ‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                <button type="button" class="btn btn-export" onclick="exportToWord()">üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô Word</button>
                <button type="button" class="btn btn-reset" onclick="resetForm()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
        </form>

        <!-- Output Section -->
        <div id="outputSection" class="output-section">
            <h2>üìã ‡∏ö‡∏ó‡∏Ñ‡∏±‡∏î‡∏¢‡πà‡∏≠ (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)</h2>
            <div id="thaiAbstract" class="output-content"></div>

            <h2>üìã Abstract (English)</h2>
            <div id="englishAbstract" class="output-content"></div>
        </div>
    </div>

    <script>
        let objectiveCount = 3;
        let findingCount = 3;

        function addObjective() {
            objectiveCount++;
            const div = document.createElement('div');
            div.className = 'dynamic-input';
            div.innerHTML = `
                <input type="text" name="objective[]" placeholder="1.${objectiveCount} ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">‡∏•‡∏ö</button>
            `;
            document.getElementById('objectives').appendChild(div);
        }

        function addMethod() {
            const div = document.createElement('div');
            div.className = 'dynamic-input';
            div.innerHTML = `
                <input type="text" name="additionalMethod[]" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏¥‡∏ò‡∏µ‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°">
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">‡∏•‡∏ö</button>
            `;
            document.getElementById('additionalMethods').appendChild(div);
        }

        function addTool() {
            const div = document.createElement('div');
            div.className = 'dynamic-input';
            div.innerHTML = `
                <input type="text" name="additionalTool[]" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°">
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">‡∏•‡∏ö</button>
            `;
            document.getElementById('additionalTools').appendChild(div);
        }

        function addFinding() {
            findingCount++;
            const div = document.createElement('div');
            div.className = 'dynamic-input';
            div.innerHTML = `
                <textarea name="finding[]" placeholder="6.${findingCount} ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤"></textarea>
                <button type="button" class="remove-btn" onclick="this.parentElement.remove()">‡∏•‡∏ö</button>
            `;
            document.getElementById('findings').appendChild(div);
        }

        function saveData() {
            const formData = new FormData(document.getElementById('researchForm'));
            localStorage.setItem('researchData', JSON.stringify(Object.fromEntries(formData)));
            alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
        }

        function generatePreview() {
            const form = document.getElementById('researchForm');
            const formData = new FormData(form);

            // Collect objectives
            const objectives = Array.from(form.querySelectorAll('input[name="objective[]"]'))
                .map(input => input.value.trim())
                .filter(val => val);

            // Collect methods
            const methods = Array.from(form.querySelectorAll('input[name="method"]:checked'))
                .map(cb => cb.value);
            const additionalMethods = Array.from(form.querySelectorAll('input[name="additionalMethod[]"]'))
                .map(input => input.value.trim())
                .filter(val => val);
            const allMethods = [...methods, ...additionalMethods];

            // Collect tools
            const tools = Array.from(form.querySelectorAll('input[name="tool"]:checked'))
                .map(cb => cb.value);
            const additionalTools = Array.from(form.querySelectorAll('input[name="additionalTool[]"]'))
                .map(input => input.value.trim())
                .filter(val => val);
            const allTools = [...tools, ...additionalTools];

            // Collect findings
            const findings = Array.from(form.querySelectorAll('textarea[name="finding[]"]'))
                .map(textarea => textarea.value.trim())
                .filter(val => val);

            // Collect keywords
            const keywords = Array.from(form.querySelectorAll('input[name="keyword[]"]'))
                .map(input => input.value.trim())
                .filter(val => val);

            const sample = form.querySelector('textarea[name="sample"]').value.trim();
            const sampleSize = form.querySelector('input[name="sampleSize"]').value.trim();
            const recommendation = form.querySelector('textarea[name="recommendation"]').value.trim();

            // Generate Thai abstract
            let thaiText = '';
            
            if (objectives.length > 0) {
                thaiText += '‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ';
                thaiText += objectives.join(' ') + ' ';
            }

            if (allMethods.length > 0) {
                thaiText += '‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ß‡∏¥‡∏à‡∏±‡∏¢' + allMethods.join(' ') + ' ';
            }

            if (allTools.length > 0) {
                thaiText += '‡πÉ‡∏ä‡πâ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà ' + allTools.join(' ') + ' ';
            }

            if (sample) {
                thaiText += '‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà ' + sample + ' ';
            }

            if (sampleSize) {
                thaiText += '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ' + sampleSize + ' ‡∏Ñ‡∏ô ';
            }

            if (findings.length > 0) {
                thaiText += '‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏ö‡∏ß‡πà‡∏≤ ' + findings.join(' ') + ' ';
            }

            if (recommendation) {
                thaiText += '‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢‡∏ô‡∏µ‡πâ ‡∏Ñ‡∏∑‡∏≠ ' + recommendation + ' ';
            }

            if (keywords.length > 0) {
                thaiText += '\n\n‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ' + keywords.join(', ');
            }

            document.getElementById('thaiAbstract').innerText = thaiText || '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°';

            // Generate English abstract (simple translation - in real use, you'd call a translation API)
            translateToEnglish(thaiText);

            document.getElementById('outputSection').style.display = 'block';
            document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
        }

        async function translateToEnglish(thaiText) {
            // This is a placeholder. In production, you would call a translation API
            // For demonstration, showing a sample translation
            const englishText = `This research aims to study [objectives]. Using [research methods] methodology, data collection tools include [tools]. The sample group or informants consist of [sample], totaling [number] participants. The study found that [findings]. Recommendations from this research include [recommendations].

Keywords: [keywords]`;
            
            document.getElementById('englishAbstract').innerText = 'Note: For actual English translation, please integrate with a translation API service like Google Translate API or Claude API.\n\n' + englishText;
        }

        function exportToWord() {
            const thaiAbstract = document.getElementById('thaiAbstract').innerText;
            const englishAbstract = document.getElementById('englishAbstract').innerText;

            if (!thaiAbstract || thaiAbstract === '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°') {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å');
                return;
            }

            const htmlContent = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset='utf-8'><title>‡∏ö‡∏ó‡∏Ñ‡∏±‡∏î‡∏¢‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢</title></head>
                <body>
                    <h2>‡∏ö‡∏ó‡∏Ñ‡∏±‡∏î‡∏¢‡πà‡∏≠ (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)</h2>
                    <p style="text-align: justify; line-height: 1.8;">${thaiAbstract.replace(/\n/g, '<br>')}</p>
                    <br><br>
                    <h2>Abstract (English)</h2>
                    <p style="text-align: justify; line-height: 1.8;">${englishAbstract.replace(/\n/g, '<br>')}</p>
                </body>
                </html>
            `;

            const blob = new Blob(['\ufeff', htmlContent], {
                type: 'application/msword'
            });

            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = '‡∏ö‡∏ó‡∏Ñ‡∏±‡∏î‡∏¢‡πà‡∏≠‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡∏à‡∏±‡∏¢.doc';
            link.click();
            URL.revokeObjectURL(url);

            alert('‚úÖ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Word ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
        }

        function resetForm() {
            if (confirm('‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                document.getElementById('researchForm').reset();
                document.getElementById('outputSection').style.display = 'none';
                
                // Reset dynamic fields to initial state
                document.getElementById('objectives').innerHTML = `
                    <div class="dynamic-input">
                        <input type="text" name="objective[]" placeholder="1.1 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                    </div>
                    <div class="dynamic-input">
                        <input type="text" name="objective[]" placeholder="1.2 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                    </div>
                    <div class="dynamic-input">
                        <input type="text" name="objective[]" placeholder="1.3 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå">
                    </div>
                `;
                
                document.getElementById('findings').innerHTML = `
                    <div class="dynamic-input">
                        <textarea name="finding[]" placeholder="6.1 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤"></textarea>
                    </div>
                    <div class="dynamic-input">
                        <textarea name="finding[]" placeholder="6.2 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤"></textarea>
                    </div>
                    <div class="dynamic-input">
                        <textarea name="finding[]" placeholder="6.3 ‡∏£‡∏∞‡∏ö‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤"></textarea>
                    </div>
                `;
                
                document.getElementById('additionalMethods').innerHTML = '';
                document.getElementById('additionalTools').innerHTML = '';
                
                objectiveCount = 3;
                findingCount = 3;
                
                alert('‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
            }
        }
    </script>
</body>
</html>
